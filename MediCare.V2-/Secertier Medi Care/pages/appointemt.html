<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Gestion des Rendez-vous</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">

<header class="bg-white shadow-md sticky top-0 z-10 p-4 flex justify-between">
    <h1 class="text-xl font-bold text-blue-600">Admin - Rendez-vous</h1>
</header>

<section class="max-w-6xl mx-auto p-4">
    <table class="min-w-full bg-white rounded-lg shadow-md">
        <thead class="bg-blue-500 text-white">
            <tr>
                <th class="py-2 px-4">Nom</th>
                <th class="py-2 px-4">Médecin</th>
                <th class="py-2 px-4">Date</th>
                <th class="py-2 px-4">Heure</th>
                <th class="py-2 px-4">Raison</th>
                <th class="py-2 px-4">Statut</th>
                <th class="py-2 px-4">Actions</th>
            </tr>
        </thead>
        <tbody id="appointmentsTable">
            <!-- Les rendez-vous seront affichés ici -->
        </tbody>
    </table>
</section>

<script>
// Charger les médecins
let doctors = JSON.parse(localStorage.getItem("doctors")) || [];

// Charger les rendez-vous
let appointments = JSON.parse(localStorage.getItem("appointments")) || [];
const tableBody = document.getElementById("appointmentsTable");

// Fonction pour afficher les rendez-vous
function renderAppointments(){
    tableBody.innerHTML = "";
    if(appointments.length === 0){
        const tr = document.createElement("tr");
        tr.innerHTML = `<td colspan="7" class="text-center py-4">Aucun rendez-vous pour le moment</td>`;
        tableBody.appendChild(tr);
        return;
    }

    appointments.forEach((app, index) => {
        const doc = doctors.find(d => d.id === parseInt(app.doctor));
        const docName = doc ? doc.name : "Médecin";
        const tr = document.createElement("tr");
        tr.classList.add("border-b");

        tr.innerHTML = `
            <td class="py-2 px-4">${app.name}</td>
            <td class="py-2 px-4">${docName}</td>
            <td class="py-2 px-4">${app.date}</td>
            <td class="py-2 px-4">${app.time}</td>
            <td class="py-2 px-4">${app.reason}</td>
            <td class="py-2 px-4">${app.status}</td>
            <td class="py-2 px-4 space-x-2">
                <button class="bg-green-500 text-white px-2 py-1 rounded acceptBtn">Accepter</button>
                <button class="bg-red-500 text-white px-2 py-1 rounded cancelBtn">Annuler</button>
            </td>
        `;
        tableBody.appendChild(tr);

        // Événements boutons
        tr.querySelector(".acceptBtn").addEventListener("click", () => {
            appointments[index].status = "Accepté";
            localStorage.setItem("appointments", JSON.stringify(appointments));
            renderAppointments();
        });
        tr.querySelector(".cancelBtn").addEventListener("click", () => {
            appointments[index].status = "Annulé";
            localStorage.setItem("appointments", JSON.stringify(appointments));
            renderAppointments();
        });
    });
}

renderAppointments();
</script>

</body>
</html>
