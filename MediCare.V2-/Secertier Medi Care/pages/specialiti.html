<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gestion des Spécialités</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <script>
    tailwind.config = { darkMode: 'class' };

    function toggleDarkMode() {
      document.documentElement.classList.toggle('dark');
    }

    function toggleSidebar() {
      const overlay = document.getElementById('overlay')
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('-translate-x-full');
      overlay.classList.toggle('hidden');
    }
  </script>
</head>

<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
  <div class="flex h-screen overflow-hidden">

    <!-- Burger Menu -->
    <button onclick="toggleSidebar()" class="md:hidden text-gray-500 dark:text-gray-400 mr-4 ml-4 z-30 fixed top-4 left-4">
      <i class="fas fa-bars text-xl"></i>
    </button>

    <!-- Sidebar (unchanged) -->
    <div id="sidebar"
      class="w-64 bg-white dark:bg-gray-800 shadow-lg transform transition-transform duration-300 md:translate-x-0 -translate-x-full fixed md:relative z-20 h-full">

      <div class="p-6 border-b border-gray-200 dark:border-gray-700">
        <h1 class="text-xl font-bold text-blue-600 dark:text-blue-400">Dashboard Admin</h1>
        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Secrétaire (admin)</p>
      </div>

      <nav class="mt-6">
        <div class="px-6 py-3 bg-blue-50 dark:bg-gray-700 border-r-4 border-blue-500">
          <a href="index.html" class="flex items-center text-blue-600 dark:text-blue-400">
            <i class="fas fa-tachometer-alt w-5 mr-3"></i>
            <span>Tableau de bord</span>
          </a>
        </div>

        <div class="px-6 py-3 hover:bg-gray-100 dark:hover:bg-gray-700">
          <a href="med.html" class="flex items-center text-gray-700 dark:text-gray-300">
            <i class="fas fa-user-md w-5 mr-3"></i>
            <span>Médecins</span>
          </a>
        </div>

        <div class="px-6 py-3 hover:bg-gray-100 dark:hover:bg-gray-700">
          <a href="specialiti.html" class="flex items-center text-gray-700 dark:text-gray-300">
            <i class="fas fa-calendar-alt w-5 mr-3"></i>
            <span>Spécialités</span>
          </a>
        </div>

        <div class="px-6 py-3 hover:bg-gray-100 dark:hover:bg-gray-700">
          <a href="desponabilite.html" class="flex items-center text-gray-700 dark:text-gray-300">
            <i class="fas fa-users w-5 mr-3"></i>
            <span>Disponibilités</span>
          </a>
        </div>

        <div class="px-6 py-3 hover:bg-gray-100 dark:hover:bg-gray-700">
          <a href="appointemt.html" class="flex items-center text-gray-700 dark:text-gray-300">
            <i class="fas fa-file-medical w-5 mr-3"></i>
            <span>Rendez-vous</span>
          </a>
        </div>
      </nav>

      <div class="absolute bottom-0 w-full p-6 border-t border-gray-200 dark:border-gray-700">
        <div class="flex items-center justify-between mb-4">
          <span class="text-gray-700 dark:text-gray-300">Mode Sombre</span>
          <button onclick="toggleDarkMode()"
            class="relative inline-flex h-6 w-11 items-center rounded-full bg-gray-300 dark:bg-gray-600 transition-colors">
            <span
              class="inline-block h-4 w-4 transform bg-white rounded-full transition-transform translate-x-1 dark:translate-x-6"></span>
          </button>
        </div>

        <button id="desconectBtn"
          class="flex items-center text-red-500 w-full py-2 px-4 rounded-lg hover:bg-red-50 dark:hover:bg-gray-700 transition-colors">
          <i class="fas fa-sign-out-alt w-5 mr-3"></i>
          <span>Déconnexion</span>
        </button>
      </div>
    </div>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto p-6 md:ml-64">

      <div class="mb-8 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
          <h1 class="text-3xl font-bold text-gray-800 dark:text-gray-100">Gestion des Spécialités</h1>
          <p class="text-gray-500 dark:text-gray-400">Gérez les spécialités médicales disponibles</p>
        </div>

        <button onclick="openModal(false)"
          class="flex items-center gap-2 bg-blue-600 text-white font-medium px-4 py-2 rounded-lg hover:bg-blue-700 transition">
          <i class="fa-solid fa-plus"></i> Ajouter une spécialité
        </button>
      </div>

      <div id="specialitesGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>

    </main>
  </div>

  <!-- Overlay -->
  <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-10 md:hidden hidden" onclick="toggleSidebar()"></div>

  <!-- Modal -->
  <div id="modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-40">
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 w-96">
      <h2 id="modalTitle" class="text-xl font-semibold mb-4 text-gray-800 dark:text-gray-100">Ajouter une Spécialité</h2>
      <form id="specialiteForm" class="space-y-4">
        <input id="nomSpecialite" type="text" placeholder="Nom de la spécialité"
          class="w-full border border-gray-300 dark:border-gray-700 rounded-lg p-2.5 dark:bg-gray-700 dark:text-white"
          required>
        <div class="flex justify-end gap-3">
          <button type="button" onclick="closeModal()"
            class="px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400">Annuler</button>
          <button id="submitBtn" type="submit"
            class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">Ajouter</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    let editMode = false;
    let currentCard = null;

    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modalTitle');
    const submitBtn = document.getElementById('submitBtn');
    const input = document.getElementById('nomSpecialite');
    const grid = document.getElementById('specialitesGrid');

    function openModal(isEdit = false, button = null) {
      editMode = isEdit;
      modal.classList.remove('hidden');

      if (editMode && button) {
        currentCard = button.closest('.specialite-card');
        const nom = currentCard.querySelector('span').textContent;
        input.value = nom;
        modalTitle.textContent = "Modifier la Spécialité";
        submitBtn.textContent = "Enregistrer";
      } else {
        modalTitle.textContent = "Ajouter une Spécialité";
        submitBtn.textContent = "Ajouter";
        input.value = "";
      }
    }

    function closeModal() {
      modal.classList.add('hidden');
    }

    function saveSpecialites() {
      const noms = Array.from(document.querySelectorAll('.specialite-card span')).map(s => s.textContent);
      localStorage.setItem('specialites', JSON.stringify(noms));
    }

    function loadSpecialites() {
      const data = JSON.parse(localStorage.getItem('specialites')) || ["Cardiologie", "Dermatologie", "Pédiatrie"];
      data.forEach(nom => createCard(nom));
    }

    function createCard(nom) {
      const card = document.createElement('div');
      card.className = "specialite-card flex justify-between items-center bg-white dark:bg-gray-800 rounded-xl shadow p-4 hover:shadow-md transition";
      card.innerHTML = `
        <div class="flex items-center gap-3">
          <div class="bg-blue-100 text-blue-600 p-3 rounded-lg"><i class="fa-solid fa-tag"></i></div>
          <span class="text-gray-800 dark:text-gray-100 font-medium">${nom}</span>
        </div>
        <div class="flex gap-2">
          <button class="p-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition" onclick="openModal(true, this)">
            <i class="fa-solid fa-pen text-gray-600"></i>
          </button>
          <button class="p-2 bg-red-100 rounded-lg hover:bg-red-200 transition" onclick="this.closest('.specialite-card').remove(); saveSpecialites();">
            <i class="fa-solid fa-trash text-red-600"></i>
          </button>
        </div>`;
      grid.appendChild(card);
    }

    document.getElementById('specialiteForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const nom = input.value.trim();
      if (!nom) return;

      if (editMode && currentCard) {
        currentCard.querySelector('span').textContent = nom;
      } else {
        createCard(nom);
      }

      saveSpecialites();
      closeModal();
    });

    loadSpecialites();

    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });

    const DesBtn = document.getElementById("desconectBtn");
    DesBtn.addEventListener('click', function () {
      window.location.href = 'login.html'
    });

    if (sessionStorage.getItem("isLoggedIn") !== "true") {
      window.location.href = "login.html";
    }
  </script>

</body>

</html>
