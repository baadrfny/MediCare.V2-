<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MediCare +</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">

<!-- Navbar -->
<header class="bg-white shadow-md sticky top-0 z-10 p-4 flex justify-between">
  <h1 class="text-xl font-bold text-blue-600">MediCare +</h1>
</header>

<!-- Main -->
<section class="max-w-4xl mx-auto p-4 space-y-6">

  <!-- Form -->
  <div class="bg-white rounded-xl shadow-md p-6 space-y-4">
    <h2 class="text-lg font-semibold text-gray-800">Nouveau Rendez-vous</h2>

    <div>
      <label>Nom complet *</label>
      <input type="text" id="name" class="w-full border rounded-lg px-3 py-2">
    </div>

    <div>
      <label>Email *</label>
      <input type="email" id="email" class="w-full border rounded-lg px-3 py-2">
    </div>

    <div>
      <label>Téléphone *</label>
      <input type="number" id="phone" class="w-full border rounded-lg px-3 py-2">
    </div>

    <div>
      <label>Médecin *</label>
      <select id="selectDoc" class="w-full border rounded-lg px-3 py-2">
        <option value="">Sélectionner...</option>
      </select>
    </div>

    <div>
      <label>Date *</label>
      <input type="date" id="date" class="w-full border rounded-lg px-3 py-2">
    </div>

    <div>
      <label>Heure *</label>
      <input type="time" id="time" class="w-full border rounded-lg px-3 py-2">
    </div>

    <div>
      <label>Raison *</label>
      <textarea id="reason" rows="3" class="w-full border rounded-lg px-3 py-2"></textarea>
    </div>

    <button id="confirmBtn" class="bg-blue-500 text-white w-full py-2 rounded-lg mt-2">Confirmer</button>
  </div>

  <!-- History -->
  <div class="bg-white rounded-xl shadow-md p-6">
    <h2 class="font-semibold text-gray-800 mb-4">Mes rendez-vous</h2>
    <div id="appointmentsList" class="space-y-2 text-gray-700">
      Aucun rendez-vous pour le moment
    </div>
  </div>

</section>

<script>
// --- Initialiser les médecins si localStorage vide ---
const defaultDoctors = [
    { id: 1, name: 'Badr', specialite: 'heart', days: [] },
    { id: 2, name: 'Ali', specialite: 'dentiste', days: [] },
    { id: 3, name: 'Ahmed', specialite: 'children', days: [] },
    { id: 4, name: 'Muslim', specialite: 'legs', days: [] }
];

if(!localStorage.getItem("doctors")){
    localStorage.setItem("doctors", JSON.stringify(defaultDoctors));
}

// --- Charger les médecins dans le select ---
let doctors = JSON.parse(localStorage.getItem("doctors"));
const selectDoc = document.getElementById("selectDoc");

doctors.forEach(doc => {
    const option = document.createElement("option");
    option.value = doc.id;
    option.textContent = doc.name;
    selectDoc.appendChild(option);
});

// --- Charger les rendez-vous ---
let appointments = JSON.parse(localStorage.getItem("appointments")) || [];
const appointmentsList = document.getElementById("appointmentsList");

function renderAppointments(){
    appointmentsList.innerHTML = "";
    if(appointments.length === 0){
        appointmentsList.textContent = "Aucun rendez-vous pour le moment";
        return;
    }
    appointments.forEach(app => {
        const p = document.createElement("p");
        const doc = doctors.find(d => d.id === parseInt(app.doctor));
        const docName = doc ? doc.name : "Médecin";
        p.textContent = `${app.date} ${app.time} - ${app.name} (${docName}) : ${app.reason} - ${app.status}`;
        appointmentsList.appendChild(p);
    });
}

renderAppointments();

// --- Ajouter un rendez-vous ---
document.getElementById("confirmBtn").addEventListener("click", e => {
    e.preventDefault();

    const name = document.getElementById("name").value.trim();
    const email = document.getElementById("email").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const doctor = selectDoc.value;
    const date = document.getElementById("date").value;
    const time = document.getElementById("time").value;
    const reason = document.getElementById("reason").value.trim();

    if(!name || !email || !phone || !doctor || !date || !time || !reason){
        alert("Veuillez remplir tous les champs !");
        return;
    }

    const newAppointment = { name, email, phone, doctor, date, time, reason, status: "en attente" };
    appointments.push(newAppointment);
    localStorage.setItem("appointments", JSON.stringify(appointments));
    renderAppointments();

    // Réinitialiser le formulaire
    document.getElementById("name").value = "";
    document.getElementById("email").value = "";
    document.getElementById("phone").value = "";
    selectDoc.value = "";
    document.getElementById("date").value = "";
    document.getElementById("time").value = "";
    document.getElementById("reason").value = "";

    alert("Rendez-vous ajouté avec succès !");
});
</script>

</body>
</html>
