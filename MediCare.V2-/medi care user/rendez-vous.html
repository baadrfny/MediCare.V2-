<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MediCare +</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">

<!-- Navbar -->
<header class="bg-white shadow-md sticky top-0 z-10 p-4 flex justify-between">
  <h1 class="text-xl font-bold text-blue-600">MediCare +</h1>
</header>

<!-- Main -->
<section class="max-w-4xl mx-auto p-4 space-y-6">

  <!-- Form -->
  <div class="bg-white rounded-xl shadow-md p-6 space-y-4">
    <h2 class="text-lg font-semibold text-gray-800">Nouveau Rendez-vous</h2>

    <div>
      <label>Nom complet </label>
      <input type="text" id="name" class="w-full border rounded-lg px-3 py-2">
    </div>

    <div>
      <label>Email </label>
      <input type="email" id="email" class="w-full border rounded-lg px-3 py-2">
    </div>

    <div>
      <label>Téléphone </label>
      <input type="number" id="phone" class="w-full border rounded-lg px-3 py-2">
    </div>

    <div>
      <label>Jour </label>
      <select id="selectDay" class="w-full border rounded-lg px-3 py-2 mb-2">
        <option value="">Sélectionner le jour</option>
        <option value="Lundi">Lundi</option>
        <option value="Mardi">Mardi</option>
        <option value="Mercredi">Mercredi</option>
        <option value="Jeudi">Jeudi</option>
        <option value="Vendredi">Vendredi</option>
        <option value="Samedi">Samedi</option>
        <option value="Dimanche">Dimanche</option>
      </select>
    </div>

    <div>
      <label>Médecin </label>
      <select id="selectDoc" class="w-full border rounded-lg px-3 py-2">
        <option value="">Sélectionner...</option>
      </select>
    </div>

    <div>
      <label>Raison </label>
      <textarea id="reason" rows="3" class="w-full border rounded-lg px-3 py-2"></textarea>
    </div>

    <button id="confirmBtn" class="bg-blue-500 text-white w-full py-2 rounded-lg mt-2">Confirmer</button>
  </div>

  <!-- History -->
  <div class="bg-white rounded-xl shadow-md p-6">
    <h2 class="font-semibold text-gray-800 mb-4">Mes rendez-vous</h2>
    <div id="appointmentsList" class="space-y-2 text-gray-700">
      Aucun rendez-vous pour le moment
    </div>
  </div>

</section>

<script>
// --- Initialiser les médecins si localStorage vide ---


let doctors = JSON.parse(localStorage.getItem("doctors info")) || [];
let appointments = JSON.parse(localStorage.getItem("appointments")) || [];

const selectDay = document.getElementById("selectDay");
const selectDoc = document.getElementById("selectDoc");
const appointmentsList = document.getElementById("appointmentsList");

// --- Afficher les médecins selon le jour choisi ---
selectDay.addEventListener("change", () => {
    const day = selectDay.value;
    selectDoc.innerHTML = '<option value="">Sélectionner...</option>';

    if(!day) return;

    const availableDoctors = doctors.filter(doc => doc.days.includes(day));

    availableDoctors.forEach(doc => {
        const option = document.createElement("option");
        option.value = doc.id;
        option.textContent = doc.nom;
        selectDoc.appendChild(option);
    });
});






// --- Afficher les rendez-vous ---
function renderAppointments(){
    appointmentsList.innerHTML = "";
    if(appointments.length === 0){
        appointmentsList.textContent = "Aucun rendez-vous pour le moment";
        return;
    }
    appointments.forEach(app => {
        const p = document.createElement("p");
        const doc = doctors.find(d => d.id === parseInt(app.doctor));
        const docName = doc ? doc.nom : "Medecin";
        p.textContent = ` (${app.day}) -  (${docName}) : ${app.reason} - ${app.status}`;
        appointmentsList.appendChild(p);
    });
}
renderAppointments();

// --- Ajouter un rendez-vous ---
document.getElementById("confirmBtn").addEventListener("click", e => {
    e.preventDefault();
    const name = document.getElementById("name").value.trim();
    const email = document.getElementById("email").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const doctor = selectDoc.value;
    const day = selectDay.value;
    const reason = document.getElementById("reason").value.trim();

    if(!name || !email || !phone || !doctor || !day || !reason){
        alert("Veuillez remplir tous les champs !");
        return;
    }

    const newAppointment = { name, email, phone, doctor, day, reason, status: "en attente" };
    appointments.push(newAppointment);
    localStorage.setItem("appointments", JSON.stringify(appointments));
    renderAppointments();

    document.getElementById("name").value = "";
    document.getElementById("email").value = "";
    document.getElementById("phone").value = "";
    selectDay.value = "";
    selectDoc.innerHTML = '<option value="">Sélectionner...</option>';
    document.getElementById("reason").value = "";

    alert("Rendez-vous ajouté avec succès !");
});
</script>

</body>
</html>